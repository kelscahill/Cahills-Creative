{% set block_media_base_class = block_media.base_class|default('c-block-media') %}

{% if block_media %}
  <div class="{{ bem_classes(block_media_base_class) }}">
    {% if block_media.figure.type %}
      <div class="{{ bem_classes(block_media_base_class, 'category') }}">
        {% include "@atoms/links/link.twig" with {
          "link": {
            "text": block_media.figure.type|capitalize,
            "url": "/" ~ block_media.figure.type
          }
        } %}
      </div>
    {% endif %}
    <div class="{{ block_media_base_class ~ '--inner' }}">
      {% if block_media.figure.image.src %}
        <div class="{{ bem_classes(block_media_base_class, 'image') }}">
          {% if block_media.figure.type %}
            <div class="{{ bem_classes(block_media_base_class, 'media') }}">
              {% include "@atoms/images/image/figure.twig" with block_media %}
              {% include "@atoms/images/icons/icon.twig" with {
                "icon": {
                  "name": block_media.figure.type ? block_media.figure.type ~ "-circle",
                  "modifiers": "xxlarge"
                }
              } %}
            </div>
          {% else %}
            {% include "@atoms/images/image/figure.twig" with block_media %}
          {% endif %}
        </div>
      {% endif %}
      <div class="{{ bem_classes(block_media_base_class, 'content') }} u-spacing--quarter">
        {% if block_media.heading.text %}
          <div class="{{ bem_classes(block_media_base_class, 'heading') }}">
            {% include "@atoms/text/heading/heading.twig" with block_media %}
          </div>
        {% endif %}
        {% if block_media.dek.text %}
          <div class="{{ bem_classes(block_media_base_class, 'dek') }}">
            {% include "@atoms/text/dek/dek.twig" with block_media %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
{% endif %}
